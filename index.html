<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ResRec â€” Restaurant Recommendation Assistant</title>

<style>

body {
    margin: 0;
    font-family: "Helvetica Neue", Arial, sans-serif;
    background: #0f0f0f;
    color: white;
}

header {
    text-align: center;
    padding: 40px 20px;
    border-bottom: 1px solid #333;
}

header h1 {
    font-size: 42px;
    letter-spacing: 2px;
    color: #d4af37;
    margin: 0;
}

header p {
    color: #bbb;
    margin-top: 10px;
}

.container {
    width: 80%;
    max-width: 900px;
    margin: 40px auto;
}

#chat {
    background: #1a1a1a;
    border-radius: 12px;
    padding: 20px;
    height: 420px;
    overflow-y: auto;
    box-shadow: 0 0 25px rgba(0,0,0,0.5);
}

.message {
    margin: 12px 0;
    line-height: 1.6;
}

.user {
    color: #8ab4f8;
}

.bot {
    color: #d4af37;
}

#micBtn {
    display: block;
    margin: 25px auto;
    padding: 18px 32px;
    font-size: 18px;
    border-radius: 30px;
    border: none;
    background: #d4af37;
    color: black;
    font-weight: bold;
    cursor: pointer;
}

#micBtn:hover {
    background: #b8962e;
}

#status {
    text-align: center;
    color: #aaa;
    margin-top: 10px;
}

footer {
    text-align: center;
    padding: 20px;
    color: #666;
    border-top: 1px solid #333;
    margin-top: 40px;
}

</style>
</head>

<body>

<header>
    <h1>ResRec</h1>
    <p>Your Personal Restaurant Recommendation Assistant</p>
</header>

<div class="container">

    <div id="chat"></div>

    <button id="micBtn">ðŸŽ¤ Speak to ResRec</button>
    <div id="status">Click the microphone and start speaking</div>

</div>

<footer>
    Â© 2026 ResRec â€” Smart Dining Recommendations
</footer>

<script>

// =============================
// CONFIGURATION
// =============================

// LOCAL (for testing)
const API_URL = "https://resrec-bot.onrender.com/chat";

// AFTER DEPLOYMENT CHANGE TO:
// const API_URL = "https://your-render-url.onrender.com/chat";


// =============================
// UI FUNCTIONS
// =============================

const chatBox = document.getElementById("chat");
const statusText = document.getElementById("status");

function addMessage(sender, text, className) {
    const msg = document.createElement("div");
    msg.className = "message " + className;
    msg.innerHTML = "<strong>" + sender + ":</strong> " + text;
    chatBox.appendChild(msg);
    chatBox.scrollTop = chatBox.scrollHeight;
}


// =============================
// TEXT TO SPEECH
// =============================

function speak(text) {
    const speech = new SpeechSynthesisUtterance(text);
    speech.lang = "en-US";
    speech.rate = 1;
    window.speechSynthesis.speak(speech);
}


// =============================
// SPEECH RECOGNITION
// =============================

const SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition;

const recognition = new SpeechRecognition();

recognition.lang = "en-US";
recognition.interimResults = false;
recognition.continuous = false;

let isListening = false;

document.getElementById("micBtn").onclick = () => {

    if (isListening) {
        recognition.stop();
        return;
    }

    statusText.innerText = "Listening...";
    recognition.start();
    isListening = true;
};


recognition.onresult = async function(event) {

    const text = event.results[0][0].transcript;

    recognition.stop();
    isListening = false;

    addMessage("You", text, "user");
    statusText.innerText = "Processing...";

    try {
        const response = await fetch(API_URL, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ message: text })
        });

        const data = await response.json();

        addMessage("ResRec", data.reply, "bot");
        speak(data.reply);

        statusText.innerText = "Click the microphone and speak again";

    } catch (error) {
        console.error("API Error:", error);
        statusText.innerText = "Server error. Try again.";
    }
};


recognition.onerror = function(event) {
    console.error("Speech Recognition Error:", event.error);
    statusText.innerText = "Speech error: " + event.error;
    recognition.stop();
    isListening = false;
};


recognition.onend = function() {
    isListening = false;
};

</script>

</body>
</html>
